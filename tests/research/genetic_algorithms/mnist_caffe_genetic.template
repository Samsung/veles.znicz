#!/usr/bin/python3.3 -O\n
"""
Created on Mart 21, 2014

Example of Mnist config.

Copyright (c) 2013 Samsung Electronics Co., Ltd.
"""

from veles.config import root

# optional parameters
root.common.snapshot_dir = \"%s\"
root.update = {"learning_rate_adjust": {"do": True}, # True False
               "decision": {"max_epochs": 10},
               "snapshotter": {"prefix": "mnist_caffe"},
               "loader": {"minibatch_size": %d},
               "weights_plotter": {"limit": 64},
               "mnist": {#"learning_rate": 0.01, "gradient_moment": 0.9, # 0-1
                         #"weights_decay": 0.0005,
                         "layers":
                         [{"type": "conv", # conv conv_relu conv_str
                           "n_kernels": %d,
                           "kx": 5, "ky": 5,
                           "sliding": (1, 1),
                           "learning_rate": %f,
                           "learning_rate_bias": %f,
                           "gradient_moment": %f,
                           "gradient_moment_bias": %f,
                           "weights_filling": "uniform", # "gaussian"
                           "weights_stddev": %f,
                           "bias_filling": "constant", # "uniform", "gaussian"
                           "bias_stddev": %f,
                           "weights_decay": %f,
                           "weights_decay_bias": %f
                           },
                          {"type": "max_pooling",# abs_pooling
                           "kx": 2, "ky": 2,
                           "sliding": (2, 2)},


                          {"type": "conv",
                           "n_kernels": %d,
                           "kx": 5, "ky": 5,
                           "sliding": (1, 1),
                           "learning_rate": %f,
                           "learning_rate_bias": %f,
                           "gradient_moment": %f,
                           "gradient_moment_bias": %f,
                           "weights_filling": "uniform",
                           "weights_stddev": %f,
                           "bias_filling": "constant",
                           "bias_stddev": %f,
                           "weights_decay": %f,
                           "weights_decay_bias": %f
                           },
                          {"type": "max_pooling",
                           "kx": 2, "ky": 2, "sliding": (2, 2)},

                          {"type": "all2all_relu",
                           "output_shape": %d, # 10 - 1000
                           "learning_rate": %f,
                           "learning_rate_bias": %f,
                           "gradient_moment": %f,
                           "gradient_moment_bias": %f,
                           "weights_filling": "uniform",
                           "weights_stddev": %f,
                           "bias_filling": "constant",
                           "bias_stddev": %f,
                           "weights_decay": %f,
                           "weights_decay_bias": %f},
                          {"type": "softmax",
                           "output_shape": 10,
                           "learning_rate": %f,
                           "learning_rate_bias": %f,
                           "gradient_moment": %f,
                           "gradient_moment_bias": %f,
                           "weights_filling": "uniform",
                           "weights_stddev": %f,
                           "bias_filling": "constant",
                           "bias_stddev": %f,
                           "weights_decay": %f,
                           "weights_decay_bias": %f}]}}
